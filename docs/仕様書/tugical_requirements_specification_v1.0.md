---
marp: true
theme: default
size: 16:9
paginate: true
header: "tugical 要件定義書"
footer: "© tugilo inc. all rights reserved"
---

# tugical（ツギカル）要件定義書

## LINE 連携型予約管理 SaaS

**Version**: 1.1  
**Date**: 2025 年 7 月 6 日  
**Author**: tugilo inc.

---

## 目次

1. **プロジェクト概要**
2. **汎用時間スロット設定**
3. **機能要件**
4. **非機能要件**
5. **データベース設計**
6. **API 設計**
7. **UI/UX 設計**
8. **プラン・料金体系**

---

## 1. プロジェクト概要

### サービス概要

- **サービス名**: tugical（ツギカル）
- **公式コンセプト**: 時間貸しリソース予約システム
- **統一概念**: 予約 = リソース × 時間枠 × メニュー
- **スローガン**: 次の時間が、もっと自由になる。
- **形態**: LINE 連携型予約管理 SaaS
- **対応業種**: 汎用プラットフォーム（5 分〜480 分の任意の時間ベース予約業務）

### 技術構成

| 要素           | 技術                              |
| -------------- | --------------------------------- |
| バックエンド   | Laravel + MariaDB                 |
| フロントエンド | React + Vite + TypeScript         |
| UI/UX          | Tailwind CSS + Framer Motion      |
| 外部連携       | LINE Messaging API + LIFF         |
| ホスティング   | VPS 統一運用 → 段階的クラウド移行 |

---

## 2. 汎用時間スロット設定

### 柔軟な時間スロット設定機能

tugical は 5 分から 480 分（8 時間）まで柔軟に設定可能な汎用時間スロット設定システムを提供します。

#### 対応業種・時間設定例

| 業種カテゴリ         | 具体例                   | 推奨時間スロット | 特徴                   |
| -------------------- | ------------------------ | ---------------- | ---------------------- |
| **医療系**           | 予防接種、診察、検査     | 5-120 分         | 短時間・高精度         |
| **美容・健康系**     | 美容院、ネイル、整体     | 30-180 分        | 技術・リラクゼーション |
| **施設・設備系**     | 会議室、レンタルスペース | 30-480 分        | 用途別柔軟設定         |
| **教育・研修系**     | 個別指導、セミナー       | 30-480 分        | 学習効果最適化         |
| **アクティビティ系** | 体験教室、アウトドア     | 60-480 分        | 体験価値重視           |

#### 技術仕様

```json
{
  "slot_duration_minutes": 30,
  "available_durations": [5, 10, 15, 30, 60, 120, 240, 480],
  "business_hours": {
    "monday": { "start": "09:00", "end": "18:00" },
    "tuesday": { "start": "09:00", "end": "18:00" },
    "wednesday": { "start": "09:00", "end": "18:00" },
    "thursday": { "start": "09:00", "end": "18:00" },
    "friday": { "start": "09:00", "end": "18:00" },
    "saturday": { "start": "09:00", "end": "17:00" },
    "sunday": { "closed": true }
  },
  "break_times": [{ "start": "12:00", "end": "13:00", "label": "昼休み" }],
  "timezone": "Asia/Tokyo"
}
```

---

## 3. 対象業種・ユースケース

### 統一概念：時間貸しリソース予約

```
予約 = リソース × 時間枠 × メニュー
```

### 医療系

| 業種     | リソース           | 時間単位  | 特徴             |
| -------- | ------------------ | --------- | ---------------- |
| 予防接種 | 医師・看護師       | 5-10 分   | 短時間・高回転   |
| 診察     | 医師・診察室       | 10-30 分  | 診療科目別       |
| 検査     | 医師・検査室・機器 | 30-120 分 | 機器専用・前処理 |
| リハビリ | 療法士・訓練室     | 30-60 分  | 個別プログラム   |

### 美容・健康系

| 業種         | リソース               | 時間単位  | 特徴             |
| ------------ | ---------------------- | --------- | ---------------- |
| 美容・ネイル | スタッフ               | 30-180 分 | 指名制・技能差   |
| 整体・施術   | 施術者                 | 30-90 分  | 繰り返し予約     |
| エステ       | エステティシャン・個室 | 60-120 分 | コース別メニュー |

### 施設・設備系

| 業種             | リソース        | 時間単位  | 特徴           |
| ---------------- | --------------- | --------- | -------------- |
| レンタルスペース | 部屋・設備      | 30-480 分 | 収容人数・設備 |
| 会議室           | 会議室・AV 設備 | 30-240 分 | 参加人数・設備 |
| スタジオ         | スタジオ・機材  | 60-240 分 | 用途別設備     |

### 教育・研修系

| 業種           | リソース   | 時間単位  | 特徴               |
| -------------- | ---------- | --------- | ------------------ |
| 教室・スクール | 講師・教室 | 30-240 分 | 定期予約・代理予約 |
| セミナー       | 講師・会場 | 60-480 分 | 大人数・長時間     |
| 個別指導       | 講師・個室 | 30-90 分  | 1 対 1・集中指導   |

### アクティビティ系

| 業種           | リソース         | 時間単位  | 特徴             |
| -------------- | ---------------- | --------- | ---------------- |
| アクティビティ | インストラクター | 60-480 分 | 定員制・条件制限 |
| 体験教室       | 講師・設備       | 60-180 分 | 初回体験・継続   |
| フィットネス   | トレーナー・設備 | 30-90 分  | 個別プログラム   |

---

## 4. プラン・料金体系

### プラン構成

| プラン               | 月額料金   | 店舗数      | 主要機能                   |
| -------------------- | ---------- | ----------- | -------------------------- |
| **フリー**           | ¥0         | 1 店舗      | 月 50 件予約、基本機能のみ |
| **スタンダード**     | ¥3,000     | 1 店舗      | 無制限予約、全機能         |
| **プロ**             | ¥8,000     | 最大 3 店舗 | 多店舗管理、高度分析       |
| **エンタープライズ** | ¥15,000 ～ | 無制限      | API 連携、専任サポート     |

### 新機能（v1.1 追加）

- **柔軟時間スロット設定**: 全プランで 5 分〜480 分設定可能
- **業種別テンプレート**: 医療・美容・施設・教育・アクティビティ
- **リアルタイム空き時間表示**: Timeline 統合表示

### オプション機能（有料）

- 決済連携：¥1,000/月
- 初期設定代行：¥30,000/回
- カスタムデザイン：¥50,000/回
- 業種別カスタマイズ：¥20,000/回（新規）

---

## 5. 機能要件 - 顧客側（LIFF）

### 予約フロー

1. **LIFF 起動・認証**

   - LINE 経由で UUID 自動取得
   - 初回：基本情報入力、リピーター：情報確認

2. **メニュー選択**

   - カテゴリ別表示
   - 料金・所要時間・詳細説明（モーダル）
   - 税込/税抜表示（管理者設定）
   - 業種別メニュー表示名対応

3. **リソース選択（スタッフ・部屋・設備等）**

   - 指名あり/なし選択
   - 専門分野・料金差表示
   - おまかせ（自動割当）オプション
   - 業種別リソース表示名対応

4. **日時選択**

   - **自動承認店舗**: 空き時間から即時確定
   - **手動承認店舗**: 第 3 希望まで選択
   - **仮押さえシステム**: 選択時に 10 分間仮予約
   - **柔軟時間スロット**: 5 分〜480 分対応

5. **個人情報入力**

   - 管理レベル選択可能（ライト/スタンダード/詳細）
   - 業種別必須項目（アレルギー・要望事項等）
   - 利用規約同意

6. **最終確認・予約確定**
   - 予約内容確認
   - キャンセル規定表示
   - 仮押さえトークンでの安全な確定

---

## 6. 機能要件 - 管理者側

### 予約管理

- **表示形式**: カレンダー・リスト・リソース別・Timeline
- **基本操作**: 承認・却下・変更・キャンセル・手動追加
- **ドラッグ&ドロップ**: 時間・担当者・日付変更
- **同時アクセス制御**: 複数スタッフでの安全な操作
- **操作ログ**: 全変更履歴の記録
- **空きスロット表示**: リアルタイム空き時間可視化
- **Timeline 統合予約作成**: 空きスロットクリック予約

### 時間スロット設定管理（新機能）

- **柔軟間隔設定**: 5 分〜480 分から選択
- **業種別推奨設定**: 医療・美容・施設・教育・アクティビティ
- **営業時間設定**: 曜日別・複数時間帯対応
- **休憩時間設定**: 昼休み・小休憩等
- **タイムゾーン対応**: 複数タイムゾーン対応
- **リアルタイム反映**: FullCalendar 即座反映

### リソース管理（汎用）

- **タイプ**: スタッフ/部屋/設備/車両/施設等
- **業種別表示名**: 「医師」「スタッフ」「講師」「部屋」「機器」等
- **属性設定**: 専門分野・料金差・制約条件
- **稼働時間**: 個別スケジュール・効率率設定
- **資格・認定**: 医療従事者・美容師・講師等
- **制約条件**: 年齢・性別・疾患等

### メニュー管理

- **基本設定**: 名称・説明・料金・標準時間
- **バッファ時間**: 事前準備・事後片付け時間
- **リソース対応**: メニュー別利用可能リソース
- **オプション**: 追加サービス・料金設定
- **業種別メニュー**: 診療科目・施術内容・コース等

### 顧客管理

- **基本情報**: LINE 情報・手動入力項目
- **履歴管理**: 予約・キャンセル・利用状況
- **ランク管理**: 自動/手動での VIP 設定
- **制限機能**: 無断キャンセル対策・予約制限
- **業種別情報**: 診察券番号・会員番号・受講履歴等
- **顧客マッチング機能**: 手動登録顧客と LINE 連携の統合
  - 電話番号ベースの既存顧客検索
  - 本人確認（SMS/メール確認コード）
  - スタッフ承認型マッチング（複数候補時）
  - 重複登録防止・データ統合

### 営業時間・定休日設定

- **基本営業時間**: 曜日別・複数時間帯対応
- **祝日対応**: 自動祝日判定・個別設定
- **シーズン営業**: 夏季・冬季等の期間別設定
- **リソース別稼働時間**: 個別シフト管理
- **柔軟時間スロット**: 5 分〜480 分対応

### キャンセル期限・料金設定

- **期限制御**: 時間ベース・メニュー別設定
- **キャンセル料**: 段階的料金・業種別ルール
- **無断キャンセル対策**: 履歴記録・予約制限機能

### LINE 通知機能

- **通知タイミング**: 予約関連・リマインダー・運営情報
- **テンプレート編集**: 業種別デフォルト・自由編集
- **配信制御**: 時間帯制限・頻度制限・顧客別設定
- **動的情報**: 顧客名・予約詳細の自動挿入

### 業種テンプレート

- **医療系**: 診察・検査・治療・リハビリ
- **美容系**: カット・カラー・パーマ・エステ
- **施設系**: 会議室・レンタルスペース・スタジオ
- **教育系**: 授業・講義・セミナー・個別指導
- **アクティビティ系**: 体験・アウトドア・フィットネス

---

## 7. 非機能要件

### パフォーマンス要件

- **LIFF 画面ロード時間**: 2 秒以内
- **予約操作完了時間**: 3 秒以内
- **管理画面表示時間**: 1 秒以内
- **同時接続数**: 1 店舗あたり 100 セッション
- **時間スロット切り替え**: 瞬時反映

### 可用性要件

- **稼働率**: 99.9%以上
- **保守時間**: 月 1 回、深夜 2-4 時
- **障害復旧**: 1 時間以内
- **データバックアップ**: 日次自動実行

### セキュリティ要件

- **データ暗号化**: 個人情報 AES-256 暗号化
- **通信暗号化**: HTTPS/TLS 1.3
- **アクセス制御**: 多要素認証対応
- **監査ログ**: 全操作記録・改ざん防止

### 拡張性要件

- **店舗数**: 1 万店舗まで対応
- **月間予約数**: 1 店舗あたり 10 万件
- **時間スロット設定**: 5 分〜480 分柔軟対応
- **業種拡張**: 新業種追加可能

---

## 8. 今後の拡張予定

### Phase 22: 設定画面 UI 実装

- 時間スロット設定画面
- 業種別推奨設定
- プレビュー機能

### Phase 23: 顧客側 LIFF 実装

- 柔軟時間スロット対応
- 業種別 UI

### Phase 24: 高度な予約機能

- 定期予約
- 繰り返し予約
- 予約テンプレート

### Phase 25: 分析・レポート機能

- 予約状況分析
- 稼働率レポート
- 業種別 KPI

---

**最終更新**: 2025 年 7 月 6 日  
**バージョン**: 1.1  
**実装状況**: Phase 21.3 完了（柔軟時間スロット設定システム）
