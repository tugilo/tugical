---
marp: true
theme: default
size: 16:9
paginate: true
header: "tugical 要件定義書 v1.1（解釈付き）"
footer: "© tugilo inc. all rights reserved"
---

# tugical（ツギカル）要件定義書 v1.1（解釈付き）

## LINE 連携型予約設計 SaaS

**Version**: 1.1（解釈付き）  
**Date**: 2025-02-11  
**Author**: tugilo inc.  
**ベース**: tugical_requirements_specification_v1.0.md

---

## 解釈ルール（必読）

本書は tugical の**全体要件を網羅した機能辞書**です。すべてが初期リリース対象ではありません。

| ルール | 内容 |
|--------|------|
| **実装優先度・可否** | **STATUS.md** を正とする。「今やる／今やらない」は STATUS と本ドキュメントの解釈タグで判断する。 |
| **業種特化** | 業種特化要件は **テンプレ／設定として後付け**する前提で扱う。業種別ロジックを初期実装に直書きしない。 |
| **迷ったとき** | 実装判断に迷った場合は **CONCEPT_REQUIREMENTS_FIT_GAP.md** を参照する。 |
| **前提ドキュメント** | 思想・スコープは tugical_project_overview.md → STATUS.md → CONCEPT_REQUIREMENTS_FIT_GAP.md の順で優先する。 |

### 解釈タグの意味

- **[MVP]** … 初期リリースで実装対象とする要件。
- **[TEMPLATE]** … 業種テンプレ／設定で後から追加する想定。現フェーズではコアに混ぜない。
- **[FUTURE]** … 将来拡張。現フェーズでは扱わない。

※ タグ付けで迷う場合は [TEMPLATE] を優先する。要件の削除は行わない。

---

## 目次

1. **プロジェクト概要**
2. **汎用時間スロット設定**
3. **対象業種・ユースケース**
4. **プラン・料金体系**
5. **機能要件 - 顧客側（LIFF）**
6. **機能要件 - 管理者側**
7. **非機能要件**
8. **今後の拡張予定**

---

## 1. プロジェクト概要

**解釈タグ**: [MVP]（本書の前提として常に有効）

### サービス概要

- **サービス名**: tugical（ツギカル）
- **公式コンセプト**: 時間貸しリソース予約システム（※ 製品の打ち出しは overview の「予約の次の行動を設計するツール」に合わせる）
- **統一概念**: 予約 = リソース × 時間枠 × メニュー
- **スローガン**: 次の時間が、もっと自由になる。
- **形態**: LINE 連携型予約管理 SaaS
- **対応業種**: 汎用プラットフォーム（5 分〜480 分の任意の時間ベース予約業務）。業種差はテンプレで後付け。

### 技術構成

| 要素           | 技術                              |
| -------------- | --------------------------------- |
| バックエンド   | Laravel + MariaDB                 |
| フロントエンド | React + Vite + TypeScript         |
| UI/UX          | Tailwind CSS + Framer Motion      |
| 外部連携       | LINE Messaging API + LIFF         |
| ホスティング   | VPS 統一運用 → 段階的クラウド移行 |

---

## 2. 汎用時間スロット設定

**解釈タグ**: [MVP]（柔軟な時間設定そのもの）。下記の業種別「推奨」は [TEMPLATE]。

### 柔軟な時間スロット設定機能

tugical は 5 分から 480 分（8 時間）まで柔軟に設定可能な汎用時間スロット設定システムを提供します。

#### 対応業種・時間設定例

**解釈タグ**: [TEMPLATE]（参考例。実装は汎用コアで行い、業種別推奨値はテンプレで後付け可能とする）

| 業種カテゴリ         | 具体例                   | 推奨時間スロット | 特徴                   |
| -------------------- | ------------------------ | ---------------- | ---------------------- |
| **医療系**           | 予防接種、診察、検査     | 5-120 分         | 短時間・高精度         |
| **美容・健康系**     | 美容院、ネイル、整体     | 30-180 分        | 技術・リラクゼーション |
| **施設・設備系**     | 会議室、レンタルスペース | 30-480 分        | 用途別柔軟設定         |
| **教育・研修系**     | 個別指導、セミナー       | 30-480 分        | 学習効果最適化         |
| **アクティビティ系** | 体験教室、アウトドア     | 60-480 分        | 体験価値重視           |

#### 技術仕様

```json
{
  "slot_duration_minutes": 30,
  "available_durations": [5, 10, 15, 30, 60, 120, 240, 480],
  "business_hours": {
    "monday": { "start": "09:00", "end": "18:00" },
    "tuesday": { "start": "09:00", "end": "18:00" },
    "wednesday": { "start": "09:00", "end": "18:00" },
    "thursday": { "start": "09:00", "end": "18:00" },
    "friday": { "start": "09:00", "end": "18:00" },
    "saturday": { "start": "09:00", "end": "17:00" },
    "sunday": { "closed": true }
  },
  "break_times": [{ "start": "12:00", "end": "13:00", "label": "昼休み" }],
  "timezone": "Asia/Tokyo"
}
```

---

## 3. 対象業種・ユースケース

**解釈タグ**: [TEMPLATE]（想定ユースケースの辞書。実装は業種名に依存しない汎用コアで行う）

### 統一概念：時間貸しリソース予約

```
予約 = リソース × 時間枠 × メニュー
```

### 医療系

| 業種     | リソース           | 時間単位  | 特徴             |
| -------- | ------------------ | --------- | ---------------- |
| 予防接種 | 医師・看護師       | 5-10 分   | 短時間・高回転   |
| 診察     | 医師・診察室       | 10-30 分  | 診療科目別       |
| 検査     | 医師・検査室・機器 | 30-120 分 | 機器専用・前処理 |
| リハビリ | 療法士・訓練室     | 30-60 分  | 個別プログラム   |

### 美容・健康系

| 業種         | リソース               | 時間単位  | 特徴             |
| ------------ | ---------------------- | --------- | ---------------- |
| 美容・ネイル | スタッフ               | 30-180 分 | 指名制・技能差   |
| 整体・施術   | 施術者                 | 30-90 分  | 繰り返し予約     |
| エステ       | エステティシャン・個室 | 60-120 分 | コース別メニュー |

### 施設・設備系

| 業種             | リソース        | 時間単位  | 特徴           |
| ---------------- | --------------- | --------- | -------------- |
| レンタルスペース | 部屋・設備      | 30-480 分 | 収容人数・設備 |
| 会議室           | 会議室・AV 設備 | 30-240 分 | 参加人数・設備 |
| スタジオ         | スタジオ・機材  | 60-240 分 | 用途別設備     |

### 教育・研修系

| 業種           | リソース   | 時間単位  | 特徴               |
| -------------- | ---------- | --------- | ------------------ |
| 教室・スクール | 講師・教室 | 30-240 分 | 定期予約・代理予約 |
| セミナー       | 講師・会場 | 60-480 分 | 大人数・長時間     |
| 個別指導       | 講師・個室 | 30-90 分  | 1 対 1・集中指導   |

### アクティビティ系

| 業種           | リソース         | 時間単位  | 特徴             |
| -------------- | ---------------- | --------- | ---------------- |
| アクティビティ | インストラクター | 60-480 分 | 定員制・条件制限 |
| 体験教室       | 講師・設備       | 60-180 分 | 初回体験・継続   |
| フィットネス   | トレーナー・設備 | 30-90 分  | 個別プログラム   |

---

## 4. プラン・料金体系

**解釈タグ**: [MVP]（プラン構成）。業種別カスタマイズオプションは [TEMPLATE]。

### プラン構成

| プラン               | 月額料金   | 店舗数      | 主要機能                   |
| -------------------- | ---------- | ----------- | -------------------------- |
| **フリー**           | ¥0         | 1 店舗      | 月 50 件予約、基本機能のみ |
| **スタンダード**     | ¥3,000     | 1 店舗      | 無制限予約、全機能         |
| **プロ**             | ¥8,000     | 最大 3 店舗 | 多店舗管理、高度分析       |
| **エンタープライズ** | ¥15,000 ～ | 無制限      | API 連携、専任サポート     |

### 新機能（v1.1 追加）

- **柔軟時間スロット設定**: 全プランで 5 分〜480 分設定可能 [MVP]
- **業種別テンプレート**: 医療・美容・施設・教育・アクティビティ [TEMPLATE]
- **リアルタイム空き時間表示**: Timeline 統合表示 [MVP]

### オプション機能（有料）

- 決済連携：¥1,000/月 [FUTURE]
- 初期設定代行：¥30,000/回 [MVP]
- カスタムデザイン：¥50,000/回 [FUTURE]
- 業種別カスタマイズ：¥20,000/回（新規）[TEMPLATE] ※ 後付けオプションとして提供

---

## 5. 機能要件 - 顧客側（LIFF）

### 予約フロー

1. **LIFF 起動・認証** **[MVP]**

   - LINE 経由で UUID 自動取得
   - 初回：基本情報入力、リピーター：情報確認

2. **メニュー選択** **[MVP]** ※ 業種別メニュー表示名は [TEMPLATE]

   - カテゴリ別表示
   - 料金・所要時間・詳細説明（モーダル）
   - 税込/税抜表示（管理者設定）
   - 業種別メニュー表示名対応 → 設定・テンプレで後付け

3. **リソース選択（スタッフ・部屋・設備等）** **[MVP]** ※ 業種別リソース表示名は [TEMPLATE]

   - 指名あり/なし選択
   - 専門分野・料金差表示
   - おまかせ（自動割当）オプション
   - 業種別リソース表示名対応 → 設定・テンプレで後付け

4. **日時選択** **[MVP]** ※ 手動承認・第3希望は [FUTURE]

   - **自動承認店舗**: 空き時間から即時確定
   - **手動承認店舗**: 第 3 希望まで選択 → 現フェーズでは対象外
   - **仮押さえシステム**: 選択時に 10 分間仮予約
   - **柔軟時間スロット**: 5 分〜480 分対応

5. **個人情報入力** **[MVP]** ※ 業種別必須項目は [TEMPLATE]

   - 管理レベル選択可能（ライト/スタンダード/詳細）
   - 業種別必須項目（アレルギー・要望事項等）→ 設定で後付け
   - 利用規約同意

6. **最終確認・予約確定** **[MVP]**
   - 予約内容確認
   - キャンセル規定表示
   - 仮押さえトークンでの安全な確定

---

## 6. 機能要件 - 管理者側

### 管理画面の認証・ロール・ダッシュボード **[MVP]**

管理者側の認証・ロール・ダッシュボードの詳細要件・仕様は、以下を正とする。

- **要件定義**: `backend/docs/admin_auth_and_role_dashboard_requirements_v1.1.md`
- **仕様書**: `backend/docs/admin_auth_and_role_dashboard_spec_v1.2.1.md`

要点のみ本書に記載する。

- **URL**: `/admin/login` と `/admin/dashboard` のみ。ロール別 URL は増やさない。
- **認証**: 店舗管理者（User + store_id）のトークン認証（Laravel Sanctum）。未認証時は `/login` へリダイレクト。
- **ロール**: owner / manager / staff / reception。表示制御のみ。ルーティング分岐は行わない。
- **ダッシュボード**: 「店舗運営の相棒」として振る舞う。**ひとことメッセージ**（最上段・固定文+条件分岐）+ **今日の予約タイムライン** + **要対応アクション** + **直近の変更・キャンセル**。既存 API のみ使用。新規 API・新規テーブル・学習・パーソナライズ・AI は導入しない。心理設計の深掘りは将来拡張とする。

※ 実装時は上記要件定義・仕様書を必ず参照すること。

### 予約管理 **[MVP]** ※ 同時アクセス制御は [FUTURE]

- **表示形式**: カレンダー・リスト・リソース別・Timeline
- **基本操作**: 承認・却下・変更・キャンセル・手動追加
- **ドラッグ&ドロップ**: 時間・担当者・日付変更
- **同時アクセス制御**: 複数スタッフでの安全な操作 → 将来拡張
- **操作ログ**: 全変更履歴の記録
- **空きスロット表示**: リアルタイム空き時間可視化
- **Timeline 統合予約作成**: 空きスロットクリック予約

### 時間スロット設定管理 **[MVP]** ※ 業種別推奨設定は [TEMPLATE]

- **柔軟間隔設定**: 5 分〜480 分から選択
- **業種別推奨設定**: 医療・美容・施設・教育・アクティビティ → テンプレで後付け
- **営業時間設定**: 曜日別・複数時間帯対応
- **休憩時間設定**: 昼休み・小休憩等
- **タイムゾーン対応**: 複数タイムゾーン対応
- **リアルタイム反映**: FullCalendar 即座反映

### リソース管理（汎用） **[MVP]** ※ 業種別表示名・資格は [TEMPLATE]

- **タイプ**: スタッフ/部屋/設備/車両/施設等
- **業種別表示名**: 「医師」「スタッフ」「講師」「部屋」「機器」等 → 設定で後付け
- **属性設定**: 専門分野・料金差・制約条件
- **稼働時間**: 個別スケジュール・効率率設定
- **資格・認定**: 医療従事者・美容師・講師等 → テンプレで後付け
- **制約条件**: 年齢・性別・疾患等

### メニュー管理 **[MVP]** ※ 業種別メニューは [TEMPLATE]

- **基本設定**: 名称・説明・料金・標準時間
- **バッファ時間**: 事前準備・事後片付け時間
- **リソース対応**: メニュー別利用可能リソース
- **オプション**: 追加サービス・料金設定
- **業種別メニュー**: 診療科目・施術内容・コース等 → テンプレで後付け

### 顧客管理 **[MVP]** ※ 業種別情報・顧客マッチング詳細は [TEMPLATE] / [FUTURE]

- **基本情報**: LINE 情報・手動入力項目
- **履歴管理**: 予約・キャンセル・利用状況
- **ランク管理**: 自動/手動での VIP 設定
- **制限機能**: 無断キャンセル対策・予約制限
- **業種別情報**: 診察券番号・会員番号・受講履歴等 → 設定で後付け
- **顧客マッチング機能**: 手動登録顧客と LINE 連携の統合 **[FUTURE]**
  - 電話番号ベースの既存顧客検索
  - 本人確認（SMS/メール確認コード）
  - スタッフ承認型マッチング（複数候補時）
  - 重複登録防止・データ統合

### 営業時間・定休日設定 **[MVP]**

- **基本営業時間**: 曜日別・複数時間帯対応
- **祝日対応**: 自動祝日判定・個別設定
- **シーズン営業**: 夏季・冬季等の期間別設定
- **リソース別稼働時間**: 個別シフト管理
- **柔軟時間スロット**: 5 分〜480 分対応

### キャンセル期限・料金設定 **[MVP]** ※ 業種別ルールは [TEMPLATE]

- **期限制御**: 時間ベース・メニュー別設定
- **キャンセル料**: 段階的料金・業種別ルール → テンプレで後付け
- **無断キャンセル対策**: 履歴記録・予約制限機能

### LINE 通知機能 **[MVP]** ※ 業種別デフォルトは [TEMPLATE]

- **通知タイミング**: 予約関連・リマインダー・運営情報
- **テンプレート編集**: 業種別デフォルト・自由編集 → 業種別はテンプレで後付け
- **配信制御**: 時間帯制限・頻度制限・顧客別設定
- **動的情報**: 顧客名・予約詳細の自動挿入

### 業種テンプレート **[TEMPLATE]**（全体を後付けオプションとして扱う）

- **医療系**: 診察・検査・治療・リハビリ
- **美容系**: カット・カラー・パーマ・エステ
- **施設系**: 会議室・レンタルスペース・スタジオ
- **教育系**: 授業・講義・セミナー・個別指導
- **アクティビティ系**: 体験・アウトドア・フィットネス

---

## 7. 非機能要件

**解釈タグ**: [MVP]（基本目標）。拡張性の「業種拡張」は [TEMPLATE]。

### パフォーマンス要件 **[MVP]**

- **LIFF 画面ロード時間**: 2 秒以内
- **予約操作完了時間**: 3 秒以内
- **管理画面表示時間**: 1 秒以内
- **同時接続数**: 1 店舗あたり 100 セッション
- **時間スロット切り替え**: 瞬時反映

### 可用性要件 **[MVP]**

- **稼働率**: 99.9%以上
- **保守時間**: 月 1 回、深夜 2-4 時
- **障害復旧**: 1 時間以内
- **データバックアップ**: 日次自動実行

### セキュリティ要件 **[MVP]**

- **データ暗号化**: 個人情報 AES-256 暗号化
- **通信暗号化**: HTTPS/TLS 1.3
- **アクセス制御**: 多要素認証対応
- **監査ログ**: 全操作記録・改ざん防止

### 拡張性要件 **[MVP]** ※ 業種拡張は [TEMPLATE]

- **店舗数**: 1 万店舗まで対応
- **月間予約数**: 1 店舗あたり 10 万件
- **時間スロット設定**: 5 分〜480 分柔軟対応
- **業種拡張**: 新業種追加可能 → テンプレ・設定で後付け

---

## 8. 今後の拡張予定

**解釈タグ**: すべて [FUTURE]。実装優先度は STATUS.md を正とする。

### Phase 22: 設定画面 UI 実装 [FUTURE]

- 時間スロット設定画面
- 業種別推奨設定
- プレビュー機能

### Phase 23: 顧客側 LIFF 実装 [FUTURE]

- 柔軟時間スロット対応
- 業種別 UI

### Phase 24: 高度な予約機能 [FUTURE]

- 定期予約
- 繰り返し予約
- 予約テンプレート

### Phase 25: 分析・レポート機能 [FUTURE]

- 予約状況分析
- 稼働率レポート
- 業種別 KPI

---

**最終更新**: 2025-02-11  
**バージョン**: 1.1（解釈付き）  
**ベース**: tugical_requirements_specification_v1.0.md  
**実装優先度**: STATUS.md および本ドキュメントの解釈タグに従う。業種特化はテンプレで後付け。
