# コンセプト × 仕様書 フィット＆ギャップ

**作成日**: 2026-02-11 15:43  
**更新日**: 2026-02-11 15:43  

**目的**: 現在のコンセプト（overview・STATUS・要件定義 v1.1 解釈付き）と、**各仕様書**（システム・DB・API・UI・テスト・デプロイ）の一致点・ずれを整理し、実装・仕様判断の基準にする。

**参照**:
- コンセプト・判断軸: `tugical_project_overview.md` / `STATUS.md` / `.cursorrules`
- 要件の解釈: `CONCEPT_REQUIREMENTS_FIT_GAP.md` / `tugical_requirements_specification_v1.1.md`
- 本ドキュメント: 仕様書を「どう読むか」の解釈ルールを固定する

---

## 1. 仕様書一覧と役割

| 仕様書 | ファイル | 役割 |
|--------|----------|------|
| システム仕様書 | `tugical_system_specification_v2.0.md` (v2.3) | アーキテクチャ・機能ブロック・Timeline・業種別UI設計・今後の実装予定 |
| データベース設計書 | `tugical_database_design_v1.0.md` (v1.2) | テーブル定義・業種別属性・時間スロット・booking_details |
| API 仕様書 | `tugical_api_specification_v1.0.md` (v1.2) | RESTful API・認証・予約・LIFF・業種別推奨設定 |
| UI/UX 設計書 | `tugical_ui_design_system_v1.0.md` (v1.0) | デザインシステム・コンポーネント・カラー・アクセシビリティ |
| テスト戦略書 | `tugical_test_strategy_v1.0.md` (v1.0) | テスト方針・ピラミッド・カバレッジ |
| デプロイメント書 | `tugical_deployment_guide_v1.0.md` (v1.2) | 統合 Laravel・Docker・CI/CD・VPS |

---

## 2. システム仕様書 v2.3 とのフィット＆ギャップ

### フィット（一致・そのまま参照してよい）

- **統合 Laravel アプリ**（frontend + backend + liff 単一アプリ）: 現状・コンセプトと一致。
- **統一概念**（予約 = リソース × 時間枠 × メニュー、複数組み合わせ）: コンセプト・実装方針と一致。
- **汎用時間スロット**（5 分〜480 分）: 汎用コアの範囲。そのまま実装の土台にする。
- **複数メニュー組み合わせ・booking_details・電話予約ワークフロー**（設計・API）: 実装済みまたは設計済み。要件 v1.1 の [MVP]/[TEMPLATE] と整合。
- **FullCalendar Timeline・Timeline 統合予約作成**: 実装済み。仕様どおりでよい。
- **LIFF 5 ステップ・仮押さえ・LINE 通知**: フェーズ1 で実装済み。仕様と方向性一致。
- **技術スタック**（React + Vite + Laravel + MariaDB + Redis + Docker）: 変更なしでよい。

### ギャップ（解釈して読む）

| 仕様書の記載 | 解釈・扱い |
|--------------|------------|
| **業種別 UI 最適化設計**（v2.2 新機能）、業種別表示名マッピング・業種別ワークフロー・業種別カラーテーマ・業種別アイコン・業種別ペルソナ | **テンプレ／設定で後付け**。現フェーズでは業種名をロジックに直書きしない。実装時は「設定・テンプレで吸収できるか」を優先する。 |
| **今後の実装予定**（Phase 18〜21）の「美容室向けカスタマイズ」「美容師向け UI/UX」「美容師向けコンポーネント」 | **業種特化は後付け**。Phase 番号・優先度は **STATUS.md を正**とする。仕様書の Phase は参考にとどめ、リリースを止めない判断を優先する。 |
| **UniversalResource の display_name（業種別表示名）** | フィールドはそのままでよい。**値の設定はテンプレ・設定で行う**想定。業種名で分岐するコードは書かない。 |
| **適用業種（例）**（医療・美容・施設・教育・アクティビティの列挙） | 想定ユースケースの**辞書**として参照。実装では業種ごとの分岐を増やさない。 |

---

## 3. データベース設計書 v1.2 とのフィット＆ギャップ

### フィット（一致・そのまま参照してよい）

- **マルチテナント**（store_id 分離・TenantScope）: 絶対遵守。仕様どおり実装する。
- **テーブル構成**（tenants, stores, resources, menus, menu_options, customers, bookings, booking_details, notifications 等）: 現状実装と一致。マイグレーションの正とする。
- **booking_details**（複数メニュー組み合わせ）: 設計・実装済み。そのまま参照してよい。
- **時間スロット設定**（stores.time_slot_settings JSON）: 汎用コア。業種別「推奨値」はテンプレで後付け。
- **命名規則・インデックス・外部キー**: 仕様に従う。

### ギャップ（解釈して読む）

| 仕様書の記載 | 解釈・扱い |
|--------------|------------|
| **stores.industry_type / industry_settings** | カラムはそのまま利用してよい。**業種による分岐ロジックは書かない**。industry_settings は「設定の入れ物」として扱い、テンプレ適用は後付けとする。 |
| **resources.display_name（業種別）** | 表示名は DB に持つ。**どの値を入れるかは設定・テンプレで決める**。業種名で条件分岐しない。 |
| **業種別推奨設定例・業種別 attributes JSON 構造例・業種別メニュー例・業種別顧客情報例** | **例としての参考**。実装で業種ごとの専用テーブルや専用ロジックを増やさない。 |
| **initializeTimeSlotSettingsForIndustry()（業種別初期設定）** | 現フェーズでは実装しない。後付けテンプレで「推奨初期値」を提供する想定。 |
| **industry_templates テーブル（Phase 22）** | 将来拡張。現フェーズでは追加しない。STATUS.md のスコープを優先する。 |

---

## 4. API 仕様書 v1.2 とのフィット＆ギャップ

### フィット（一致・そのまま参照してよい）

- **認証**（Sanctum・Bearer）: 管理者 API の正とする。
- **LIFF API**（store_id 前提・認証不要の顧客向け）: 実装済みの LiffController と整合。
- **レスポンス形式・エラー形式・HTTP ステータス**: 仕様に従う。
- **予約 CRUD・hold-slots・availability・bookings/calculate・bookings/combination**: 実装の土台。仕様どおりでよい。
- **店舗・メニュー・リソース・顧客・通知 API**: 汎用コアの範囲。

### ギャップ（解釈して読む）

| 仕様書の記載 | 解釈・扱い |
|--------------|------------|
| **業種別推奨設定**（時間スロット等） | API で業種名を必須パラメータにしない。**推奨値はテンプレ・設定で返す**想定で、現フェーズでは汎用パラメータのみで実装する。 |
| **将来の LIFF 拡張**（業種別必須項目・業種別表示名の API） | 実装する場合は**設定キー／テンプレ ID で差を吸収**する設計にする。業種名をパスや必須パラメータにしない。 |

---

## 5. UI/UX 設計書 v1.0 とのフィット＆ギャップ

### フィット（一致・そのまま参照してよい）

- **デザイン原則**（Mobile First, Touch Friendly, Accessibility, Consistency, Performance）: コンセプトの「迷わない・失敗しない」と整合。
- **カラー・ステータスカラー・コンポーネント仕様**: 共通 UI の土台。そのまま参照してよい。
- **タッチターゲット 44px 以上**: 電話予約・片手操作を想定した仕様として維持する。

### ギャップ（解釈して読む）

| 仕様書の記載 | 解釈・扱い |
|--------------|------------|
| **ターゲット: 美容・サービス業界の店舗オーナー** | コンセプトの**一次ペルソナ**（50代前後・IT苦手・LINEは使える）に読み替える。業種名で UI を分岐させない。 |
| **「直感的」などの表現** | overview の推奨表現（迷わない・失敗しない・前と同じ感覚）を優先。NG ワードは overview に合わせる。 |

---

## 6. テスト戦略書 v1.0 とのフィット＆ギャップ

### フィット（一致・そのまま参照してよい）

- **テストピラミッド**（Unit / API / E2E）: 方針として維持する。
- **品質方針**（予約整合性・LINE 連携・マルチテナント分離・パフォーマンス・セキュリティ）: リリースを遅らせない範囲で優先度を付けてよい。STATUS.md の「次にやること」と合わせる。
- **カバレッジ目標**は参考。現フェーズでは**重要 API（予約・LIFF・空き時間）の Feature テスト**を優先する。

### ギャップ（解釈して読む）

| 仕様書の記載 | 解釈・扱い |
|--------------|------------|
| **業種別シナリオ・業種別 KPI** | 現フェーズでは対象にしない。**汎用コアのテスト**に集中する。業種別テストはテンプレ導入後に追加する想定。 |

---

## 7. デプロイメント書 v1.0 とのフィット＆ギャップ

### フィット（一致・そのまま参照してよい）

- **統合 Laravel アプリケーション**・単一 Docker・Vite ビルド: 現構成と一致。
- **GitHub Actions・VPS 戦略・環境分離**: リリースを遅らせない運用としてそのまま参照してよい。

### ギャップ（解釈して読む）

- 特記事項なし。業種に依存する記述は少なく、**フィット主体**で読んでよい。

---

## 8. 実装時の判断ルール（仕様書を読むとき）

1. **優先順位**  
   実装スコープ・優先度は **STATUS.md** を最優先する。仕様書の「今後の実装予定」や Phase 番号は**参考**とし、リリースを止めない判断を優先する。

2. **業種の扱い**  
   仕様書に「業種別○○」とあっても、**業種名をロジック・API・DB 制約に直書きしない**。  
   → 設定・テンプレ・JSON で吸収する設計にする。`.cursorrules` の「業種特化の扱い」を満たす。

3. **矛盾したとき**  
   - 仕様書どうしの矛盾: **システム仕様書 ＞ DB ＞ API ＞ UI** の順で優先する。細部は DB/API の実装済みに合わせる。  
   - 仕様書 vs コンセプト（業種を今やるか）: **コンセプト・STATUS を優先**する。CONCEPT_REQUIREMENTS_FIT_GAP.md および本ドキュメントの解釈に従う。

4. **要件定義 v1.1 との関係**  
   要件定義 v1.1 の解釈タグ（[MVP]/[TEMPLATE]/[FUTURE]）と、本ドキュメントの「仕様書の解釈」を**両方**満たすように実装する。要件が「何をやるか」、仕様書が「どう作るか」の参照とする。

---

## 9. まとめ表

| 仕様書 | フィットの中心 | ギャップの中心 | 読むときの注意 |
|--------|----------------|----------------|----------------|
| システム仕様書 | 統合構成・Timeline・複数メニュー・LIFF・汎用時間 | 業種別 UI・業種別ペルソナ・「美容師向け」Phase | 業種はテンプレで後付け。Phase は STATUS 優先。 |
| DB 設計書 | テーブル・store_id・booking_details・時間スロット | industry_*・業種別例・業種別初期設定 | カラムは使うが業種分岐は書かない。 |
| API 仕様書 | 認証・予約・LIFF・レスポンス形式 | 業種別推奨設定の必須化 | 業種を必須パラメータにしない。 |
| UI/UX 設計書 | デザイン原則・カラー・コンポーネント・44px | ターゲット文言・「直感的」 | ペルソナは overview に合わせる。 |
| テスト戦略書 | ピラミッド・品質方針 | 業種別シナリオ | 汎用コアのテストを優先。 |
| デプロイメント書 | 統合 Laravel・Docker・CI/CD | 特になし | そのまま参照してよい。 |

---

**本ドキュメントの使い方**: 仕様書を実装に落とすとき、「この記載は今やるか・テンプレで後か・業種を混ぜないか」を本ドキュメントと CONCEPT_REQUIREMENTS_FIT_GAP.md で確認する。コンセプトと仕様書の両方を満たす「判断できる地図」として使う。
